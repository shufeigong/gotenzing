!function(e){e(document).ready(function(){var a,o=e(".modal.carousel.slide.gallery, .modal.carousel.slide.popup"),n=e(".modal.modal-fullscreen"),t=e(".modal.popup"),i=e(".modal.modal-content-box"),d=!0,r=new TimelineMax({repeat:-1,repeatDelay:5,yoyo:!0});o.on("slide.bs.carousel",function(a){var o=a.relatedTarget,n=e(o).find(".lazy"),t=n.attr("data-src");if(""!==t){var i=e(this).find(".carousel-inner").hide(),d=e(this).find(".carousel-indicators").hide(),r=e(".modal-body",this).find(".lazy-loading");r.show();var s,l=e.Deferred();s=n.attr("data-src"),s&&(l=e.Deferred(),n.one("load",l.resolve).attr("src",s).attr("data-src","")),e.when(l).done(function(){r.fadeOut(1e3),i.fadeIn(1e3),d.fadeIn(1e3)})}}),o.on("slid.bs.carousel",function(o){var n=o.relatedTarget,t=e(n).find(".videoWrapper").length>0,i=e(n).find(".video-play-button");if(t){var d=e(n).find("iframe").get(0);a=$f(d),a.api("setColor","#f7a800"),a.addEvent("ready",function(){e(n).find(".videoWrapper .video-play-button").fadeIn(),a.addEvent("pause",function(){i.fadeIn()}),a.addEvent("play",function(){i.fadeOut()}),a.api("play")}),i.bind("click",function(){a.api("play")})}else null!=a&&a.api("pause")}),o.on("show.bs.modal",function(a){var o=e(this),n=e(a.relatedTarget).attr("data-slide-to"),t=e(".carousel-inner",this).find(".item").eq(n),i=e(t).find(".lazy"),d=i.attr("data-src");if(""!==d){var r,s=e(this).find(".carousel-inner").hide(),l=e(this).find(".carousel-indicators").hide(),c=e(".modal-body",this).find(".lazy-loading"),f=e.Deferred();r=i.attr("data-src"),r&&(f=e.Deferred(),i.one("load",f.resolve).attr("src",r).attr("data-src","")),e.when(f).done(function(){c.fadeOut(1e3),s.fadeIn(1e3),l.fadeIn(1e3),o.trigger("slid")})}else e(this).find(".carousel-inner").show(),e(this).find(".carousel-indicators").show();var u=3040+10*e(".modal:visible").length;e(this).css("z-index",u),e("body").css("overflow","hidden"),setTimeout(function(){e(".modal-backdrop").addClass("modal-backdrop-gallery").css("z-index",3035)},0)}),o.on("shown.bs.modal",function(a){e(".carousel.fade.in").each(function(){e(this).carousel({interval:!1})})}),o.on("hide.bs.modal",function(o){e("body").css("overflow","auto"),e(this).find(".carousel-inner").hide(),e(this).find(".carousel-indicators").hide(),null!=a&&a.api("pause"),a=null,d=!0}),n.on("show.bs.modal",function(a){console.log("full show"),e(".modal-fullscreen.fade.in").modal("hide"),e(this).focus()}),n.on("shown.bs.modal",function(a){var o=a.currentTarget;if("contact"==e(o).attr("id")){var n=e(window),t=[],i=e("#toronto-map, #london-map").lazyLoadGoogleMaps({api_key:"AIzaSyD_VREr-We898pVftz2T3c9EU7kKkylSPs",callback:function(a,o){var n=e(a),i=new google.maps.LatLng(n.attr("data-lat"),n.attr("data-lng"));o.setOptions({zoom:15,center:i}),new google.maps.Marker({position:i,map:o,animation:google.maps.Animation.DROP,draggable:!0}),e.data(o,"center",i),t.push(o),n.find(".lazy-loading").fadeOut()}});n.on("resize",i.debounce(1e3,function(){e.each(t,function(){this.setCenter(e.data(this,"center"))})}))}e(o).find(".modal-body").css("overflow-y","auto"),r.clear(),r.add(TweenMax.to(e(o).find(".utility-close-button"),2,{rotation:360,transformOrigin:"50% 50%",ease:Sine.easeInOut})),e(o).find(".utility-close-icon").hover(function(){TweenMax.to(e(o).find(".utility-close-button"),.5,{rotation:90,transformOrigin:"50% 50%",ease:Back.easeOut})},function(){TweenMax.to(e(o).find(".utility-close-button"),.5,{rotation:0,transformOrigin:"50% 50%",ease:Back.easeOut})})}),i.on("shown.bs.modal",function(a){var o=a.currentTarget;e(o).find(".modal-body").css("overflow-y","auto"),r.clear(),r.add(TweenMax.to(e(o).find(".utility-close-button"),2,{rotation:360,transformOrigin:"50% 50%",ease:Sine.easeInOut})),e(o).find(".utility-close-icon").hover(function(){TweenMax.to(e(o).find(".utility-close-button"),.5,{rotation:90,transformOrigin:"50% 50%",ease:Back.easeOut})},function(){TweenMax.to(e(o).find(".utility-close-button"),.5,{rotation:0,transformOrigin:"50% 50%",ease:Back.easeOut})})}),n.on("hide.bs.modal",function(a){e("body").removeClass("full-screen-modal-open"),e(a.currentTarget).find(".modal-body").css("overflow-y",""),r.clear()}),n.on("hidden.bs.modal",function(a){e("body").css("overflow","auto")}),t.on("hidden.bs.modal",function(a){e("body").css("overflow","auto")})})}(jQuery);