!function(e){e(document).ready(function(){var o,a=e(".modal.carousel.slide.gallery, .modal.carousel.slide.popup"),n=e(".modal.modal-fullscreen"),t=e(".modal.popup"),i=e(".modal.modal-content-box"),d=!0,s=new TimelineMax({repeat:-1,repeatDelay:5,yoyo:!0});a.on("slide.bs.carousel",function(o){var a=o.relatedTarget,n=e(a).find(".lazy"),t=n.attr("data-src");if(""!==t){var i=e(this).find(".carousel-inner").hide(),d=e(this).find(".carousel-indicators").hide(),s=e(".modal-body",this).find(".lazy-loading");s.show();var r,l=e.Deferred();r=n.attr("data-src"),r&&(l=e.Deferred(),n.one("load",l.resolve).attr("src",r).attr("data-src","")),e.when(l).done(function(){s.fadeOut(1e3),i.fadeIn(1e3),d.fadeIn(1e3)})}}),a.on("slid.bs.carousel",function(a){var n=a.relatedTarget,t=e(n).find(".videoWrapper").length>0,i=e(n).find(".video-play-button");if(t){var d=e(n).find("iframe").get(0);o=$f(d),o.addEvent("ready",function(){e(n).find(".videoWrapper .video-play-button").fadeIn(),o.addEvent("pause",function(){i.fadeIn()}),o.addEvent("play",function(){i.fadeOut()}),o.api("play")}),i.bind("click",function(){o.api("play")})}else null!=o&&o.api("pause")}),a.on("show.bs.modal",function(o){var a,n=e(this),t=e(this).find(".carousel-inner").hide(),i=e(this).find(".carousel-indicators").hide(),d=e(".modal-body",this).find(".lazy-loading"),s=e(o.relatedTarget).attr("data-slide-to"),r=e(".carousel-inner",this).find(".item").eq(s),l=e(r).find(".lazy"),c=e.Deferred();a=l.attr("data-src"),a&&(c=e.Deferred(),l.one("load",c.resolve).attr("src",a).attr("data-src","")),e.when(c).done(function(){d.fadeOut(1e3),t.fadeIn(1e3),i.fadeIn(1e3),n.trigger("slid")});var f=3040+10*e(".modal:visible").length;e(this).css("z-index",f),e("body").css("overflow","hidden"),setTimeout(function(){e(".modal-backdrop").addClass("modal-backdrop-gallery").css("z-index",3035)},0)}),a.on("shown.bs.modal",function(o){e(".carousel.fade.in").each(function(){e(this).carousel({interval:!1})})}),a.on("hide.bs.modal",function(a){e("body").css("overflow","auto"),e(this).find(".carousel-inner").hide(),e(this).find(".carousel-indicators").hide(),o=null,d=!0}),n.on("show.bs.modal",function(o){console.log("full show"),e(".modal-fullscreen.fade.in").modal("hide"),e("body").addClass("full-screen-modal-open");var a=1040+10*e(".modal:visible").length;e(this).css("z-index",a),e(this).focus()}),n.on("shown.bs.modal",function(o){e("body").css("overflow","hidden"),e(this).css({overflow:"hidden"});var a=o.currentTarget;if("contact"==e(a).attr("id")){var n=e(window),t=[],i=e("#toronto-map, #london-map").lazyLoadGoogleMaps({api_key:"AIzaSyD_VREr-We898pVftz2T3c9EU7kKkylSPs",callback:function(o,a){var n=e(o),i=new google.maps.LatLng(n.attr("data-lat"),n.attr("data-lng"));a.setOptions({zoom:15,center:i}),new google.maps.Marker({position:i,map:a,animation:google.maps.Animation.DROP,draggable:!0}),e.data(a,"center",i),t.push(a)}});n.on("resize",i.debounce(1e3,function(){e.each(t,function(){this.setCenter(e.data(this,"center"))})}))}e(a).find(".modal-body").css("overflow-y","auto"),s.clear(),s.add(TweenMax.to(e(a).find(".utility-close-button"),2,{rotation:360,transformOrigin:"50% 50%",ease:Sine.easeInOut})),e(a).find(".utility-close-icon").hover(function(){TweenMax.to(e(a).find(".utility-close-button"),.5,{rotation:90,transformOrigin:"50% 50%",ease:Back.easeOut})},function(){TweenMax.to(e(a).find(".utility-close-button"),.5,{rotation:0,transformOrigin:"50% 50%",ease:Back.easeOut})})}),i.on("shown.bs.modal",function(o){e("body").css("overflow","hidden"),e(this).css("overflow","hidden");var a=o.currentTarget;e(a).find(".modal-body").css("overflow-y","auto"),s.clear(),s.add(TweenMax.to(e(a).find(".utility-close-button"),2,{rotation:360,transformOrigin:"50% 50%",ease:Sine.easeInOut})),e(a).find(".utility-close-icon").hover(function(){TweenMax.to(e(a).find(".utility-close-button"),.5,{rotation:90,transformOrigin:"50% 50%",ease:Back.easeOut})},function(){TweenMax.to(e(a).find(".utility-close-button"),.5,{rotation:0,transformOrigin:"50% 50%",ease:Back.easeOut})})}),n.on("hide.bs.modal",function(o){e("body").removeClass("full-screen-modal-open"),e(o.currentTarget).find(".modal-body").css("overflow-y",""),s.clear()}),n.on("hidden.bs.modal",function(o){e("body").css("overflow","auto")}),t.on("hidden.bs.modal",function(o){e("body").css("overflow","auto")})})}(jQuery);