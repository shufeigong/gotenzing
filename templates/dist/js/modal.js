!function(o){o(document).ready(function(){var a,e=o(".modal.carousel.slide.gallery, .modal.carousel.slide.popup"),n=o(".modal.modal-fullscreen"),t=o(".modal.popup"),i=o(".modal.modal-content-box"),d=o(".carousel.slide.subpage,.carousel.slide.mobile"),l=!0,s=new TimelineMax({repeat:-1,repeatDelay:5,yoyo:!0});d.on("slide.bs.carousel",function(a){var e;e=o(a.relatedTarget).find("img[data-original]"),e.attr("src",e.data("original")),e.removeAttr("data-original")}),e.on("slide.bs.carousel",function(a){var e;e=o(a.relatedTarget).find("img[data-original]"),e.attr("src",e.data("original")),e.removeAttr("data-original"),e.on("load",function(){e.removeClass("lazy").addClass("lazy-loaded")})}),e.on("slid.bs.carousel",function(e){var n=e.relatedTarget,t=o(n).find(".videoWrapper").length>0;if(t){var i=o(n).find("iframe").get(0),d=o(i).hasClass("lazy-loaded");d||o(n).find(".videoWrapper").find("iframe[data-src]").lazyLoadXT(),a=$f(i);var l=o(n).find(".video-play-button");a.addEvent("ready",function(){o(n).find(".videoWrapper .video-loading-icon").fadeOut(),o(n).find(".videoWrapper .video-play-button").fadeIn(),a.addEvent("pause",function(){l.fadeIn()}),a.addEvent("play",function(){l.fadeOut()}),a.api("play")}),l.bind("click",function(){a.api("play")})}else void 0!=a&&a.api("pause")}),e.on("show.bs.modal",function(a){var e=3040+10*o(".modal:visible").length;o(this).css("z-index",e),o("body").css("overflow","hidden"),setTimeout(function(){o(".modal-backdrop").addClass("modal-backdrop-gallery").css("z-index",3035)},0)}),e.on("hide.bs.modal",function(){void 0!=a&&a.api("unload"),o("body").css("overflow","auto"),l=!0}),n.on("show.bs.modal",function(a){console.log("full show"),o(".modal-fullscreen.fade.in").modal("hide"),o("body").addClass("full-screen-modal-open");var e=1040+10*o(".modal:visible").length;o(this).css("z-index",e),o(this).focus()}),t.on("show.bs.modal",function(o){console.log("popup mobile show")}),n.on("shown.bs.modal",function(a){o("body").css("overflow","hidden"),o(this).css({overflow:"hidden"});var e=a.currentTarget;if("contact"==o(e).attr("id")){var n=o(window),t=[],i=o("#toronto-map, #london-map").lazyLoadGoogleMaps({api_key:"AIzaSyD_VREr-We898pVftz2T3c9EU7kKkylSPs",callback:function(a,e){var n=o(a),i=new google.maps.LatLng(n.attr("data-lat"),n.attr("data-lng"));e.setOptions({zoom:15,center:i}),new google.maps.Marker({position:i,map:e,animation:google.maps.Animation.DROP,draggable:!0}),o.data(e,"center",i),t.push(e)}});n.on("resize",i.debounce(1e3,function(){o.each(t,function(){this.setCenter(o.data(this,"center"))})}))}o(e).find(".modal-body").css("overflow-y","auto"),s.clear(),s.add(TweenMax.to(o(e).find(".utility-close-button"),2,{rotation:360,transformOrigin:"50% 50%",ease:Sine.easeInOut})),o(e).find(".utility-close-icon").hover(function(){TweenMax.to(o(e).find(".utility-close-button"),.5,{rotation:90,transformOrigin:"50% 50%",ease:Back.easeOut})},function(){TweenMax.to(o(e).find(".utility-close-button"),.5,{rotation:0,transformOrigin:"50% 50%",ease:Back.easeOut})})}),i.on("shown.bs.modal",function(a){o("body").css("overflow","hidden"),o(this).css("overflow","hidden");var e=a.currentTarget;s.clear(),s.add(TweenMax.to(o(e).find(".utility-close-button"),2,{rotation:360,transformOrigin:"50% 50%",ease:Sine.easeInOut})),o(e).find(".utility-close-icon").hover(function(){TweenMax.to(o(e).find(".utility-close-button"),.5,{rotation:90,transformOrigin:"50% 50%",ease:Back.easeOut})},function(){TweenMax.to(o(e).find(".utility-close-button"),.5,{rotation:0,transformOrigin:"50% 50%",ease:Back.easeOut})})}),n.on("hide.bs.modal",function(a){o("body").removeClass("full-screen-modal-open"),o(a.currentTarget).find(".modal-body").css("overflow-y",""),s.clear()}),n.on("hidden.bs.modal",function(a){o("body").css("overflow","auto")}),t.on("hidden.bs.modal",function(a){o("body").css("overflow","auto")})})}(jQuery);